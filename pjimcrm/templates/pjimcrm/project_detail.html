{% extends "pjimcrm/base.html" %}

{% block page_title %}{{ project_record.name }} [Project] - PJim CRM Home{% endblock %}
{% block nav %}
    <nav>
        <a href="{% url 'index' %}" class="navActive">
            <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path d="M48 0C21.5 0 0 21.5 0 48L0 464c0 26.5 21.5 48 48 48l96 0 0-80c0-26.5 21.5-48 48-48s48 21.5 48 48l0 80 96 0c26.5 0 48-21.5 48-48l0-416c0-26.5-21.5-48-48-48L48 0zM64 240c0-8.8 7.2-16 16-16l32 0c8.8 0 16 7.2 16 16l0 32c0 8.8-7.2 16-16 16l-32 0c-8.8 0-16-7.2-16-16l0-32zm112-16l32 0c8.8 0 16 7.2 16 16l0 32c0 8.8-7.2 16-16 16l-32 0c-8.8 0-16-7.2-16-16l0-32c0-8.8 7.2-16 16-16zm80 16c0-8.8 7.2-16 16-16l32 0c8.8 0 16 7.2 16 16l0 32c0 8.8-7.2 16-16 16l-32 0c-8.8 0-16-7.2-16-16l0-32zM80 96l32 0c8.8 0 16 7.2 16 16l0 32c0 8.8-7.2 16-16 16l-32 0c-8.8 0-16-7.2-16-16l0-32c0-8.8 7.2-16 16-16zm80 16c0-8.8 7.2-16 16-16l32 0c8.8 0 16 7.2 16 16l0 32c0 8.8-7.2 16-16 16l-32 0c-8.8 0-16-7.2-16-16l0-32zM272 96l32 0c8.8 0 16 7.2 16 16l0 32c0 8.8-7.2 16-16 16l-32 0c-8.8 0-16-7.2-16-16l0-32c0-8.8 7.2-16 16-16z"/></svg>
            <span>Clients</span>
        </a>
        <div class="vbar"></div>
        <a href="{% url 'timer_index' %}">
            <svg class="icon" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path d="M464 256A208 208 0 1 1 48 256a208 208 0 1 1 416 0zM0 256a256 256 0 1 0 512 0A256 256 0 1 0 0 256zM232 120l0 136c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2 280 120c0-13.3-10.7-24-24-24s-24 10.7-24 24z"/></svg>
            <span>Timer</span>
        </a>
    </nav>
{% endblock %}
{% block topnav %}
    <a href="{% url 'client_detail' project_record.client.id %}">
        <svg class="icon" aria-role="img" aria-label="Back" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg>
    </a>
    <div class="navHeadingAndSubheading">
        <h1 class="navHeading">{{ project_record.name }}</h1>
        <p class="navSubheading">Project @ {{ project_record.client.name }}</p>
    </div>
    <a class="topnavButton topnavButtonIcon" href="{% url 'project_edit' project_record.client.id project_record.id %}">
        <svg class="icon" aria-role="img" title="Edit" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path d="M441 58.9L453.1 71c9.4 9.4 9.4 24.6 0 33.9L424 134.1 377.9 88 407 58.9c9.4-9.4 24.6-9.4 33.9 0zM209.8 256.2L344 121.9 390.1 168 255.8 302.2c-2.9 2.9-6.5 5-10.4 6.1l-58.5 16.7 16.7-58.5c1.1-3.9 3.2-7.5 6.1-10.4zM373.1 25L175.8 222.2c-8.7 8.7-15 19.4-18.3 31.1l-28.6 100c-2.4 8.4-.1 17.4 6.1 23.6s15.2 8.5 23.6 6.1l100-28.6c11.8-3.4 22.5-9.7 31.1-18.3L487 138.9c28.1-28.1 28.1-73.7 0-101.8L474.9 25C446.8-3.1 401.2-3.1 373.1 25zM88 64C39.4 64 0 103.4 0 152L0 424c0 48.6 39.4 88 88 88l272 0c48.6 0 88-39.4 88-88l0-112c0-13.3-10.7-24-24-24s-24 10.7-24 24l0 112c0 22.1-17.9 40-40 40L88 464c-22.1 0-40-17.9-40-40l0-272c0-22.1 17.9-40 40-40l112 0c13.3 0 24-10.7 24-24s-10.7-24-24-24L88 64z"/></svg>
    </a>
{% endblock %}
{% block precontent %}
{% include "pjimcrm/snippets/timer_banner.html" %}
{% endblock %}
{% block content %}
<div class="atkinson-hyperlegible-next-regular">
    <div>
        {% if project_record %}
            <p>Description: {{ project_record.description }}</p>
            <ul>
            {% for project_record in project_record.project_set.all %}
                <li><a href="{% url 'project_detail' project_record.id project_record.id %}">{{ client_record.name }}</a></li>
            {% endfor %}
            </ul>
        {% endif %}
    </div>
    <h2>Pending Timers</h2>
    <div class="timerListOuter">
    <table class="timerListTable">
    <thead>
        <tr>
            <th scope="col">Timer</th>
            <th scope="col">Date</th>
            <th scope="col">Time</th>
            <th scope="col">Actions</th>
        </tr>
    </thead>
    <tbody>
    {% if timer_list %}
        {% for timer_record in timer_list %}
        <tr>
            <th class="timer_name" scope="row">
                {% if timer_record.description_set %}
                <span class="timer_description">{{ timer_record.description }}</span>
                <span class="timer_description_extra">{{ timer_record.project.name }} - {{timer_record.project.client.name }}</span>
                <a href="">{{ timer_record.name }}

                </a>
                {% else %}
                <a href="">{{ timer_record.name }}</a>
                {% endif %}
            </th>
            <td class="timer_time">{{ timer_record.created_date|date:"d/m/y" }}</td>
            <td class="timer_time">{{ timer_record.length_raw }}</td>
            <td class="timer_actions">
                <form method="post" action="{% url 'timer_delete' %}">
                    <input type="hidden" name="id" value="{{ timer_record.id }}" />
                    <input type="hidden" name="retUrl" value="{{ request.get_full_path }}" />
                    {% csrf_token %}
                    <input class="flatButton" type="submit" value="Delete" />
                </form>
            </td>
        </tr>
        {% endfor %}
    {% else %}
        <tr><td colspan="2">No timers</td></tr>
    {% endif %}
    </tbody>
    </table>
    <h2>Invoiced Entries</h2>
    <div class="timerListOuter">
    <table class="timerListTable">
    <thead>
        <tr>
            <th scope="col">Timer</th>
            <th scope="col">Date</th>
            <th scope="col">Time</th>
        </tr>
    </thead>
    <tbody>
    {% if timer_invoiced_list %}
        {% for timer_record in timer_invoiced_list %}
        <tr>
            <th class="timer_name" scope="row">
                {% if timer_record.description_set %}
                <span class="timer_description">{{ timer_record.description }}</span>
                <span class="timer_description_extra">{{ timer_record.project.name }} - {{timer_record.project.client.name }}</span>
                <a href="">{{ timer_record.name }}

                </a>
                {% else %}
                <a href="">{{ timer_record.name }}</a>
                {% endif %}
            </th>
            <td class="timer_time">{{ timer_record.created_date|date:"d/m/y" }}</td>
            <td class="timer_time">{{ timer_record.length_raw }}</td>
        </tr>
        {% endfor %}
    {% else %}
        <tr><td colspan="2">No timers</td></tr>
    {% endif %}
    </tbody>
    </table>
</div>
{% endblock %}
